ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0.01, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0.01, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
R.version
library("BSgenome.Hsapiens.UCSC.hg38")
#--------- WD & LOAD FILES --------------------------------------------------------------------------------------------
setwd("C:/Users/rockp/Desktop/UCL/Project/Project-Laura")
library(RColorBrewer)
library(reshape2)
library(survival)
library(TCGAbiolinks)
require(FirebrowseR)
# Clinical and mutsigs data
load("./Output/TCGA_SKCM_TP_clinical.RData")    # SKCM TP
load("./Output/TCGA_SKCM_TM_clinical.RData")    # SKCM TM
load("./Output/TCGA_UVM_TP_clinical.RData")     # UVM TP
# Stage
load("./Output/TCGA_SKCM_TP_stage.RData")       # SKCM TP
load("./Output/TCGA_SKCM_TM_stage.RData")       # SKCM TM
# Mutsigs, metscores, and stage
load("./Output/TCGA_SKCM_TP_metastatic_score_stage.RData")      # SKCM TP
load("./Output/TCGA_SKCM_TM_metastatic_score_stage.RData")      # SKCM TM
load("./Output/TCGA_UVM_TP_metastatic_score_stage.RData")       # UVM TP
# Survival
load("./Output/TCGA_SKCM_TP_survival.RData")        # SKCM TP
load("./Output/TCGA_SKCM_TM_survival.RData")        # SKCM TM
load("./Output/TCGA_UVM_TP_survival.RData")         # UVM
# ICGC data
load("./Output/ICGC_SKCA_BR_clin_ther_mutsig.RData")    # SKCA-BR
load("./Output/ICGC_MELA_AU_clin_ther_mutsig.RData")    # MELA-AU
# All cutaneous melanoma data survival
load("./Output/ICGC_TCGA_survival.RData")
cut.coh <- summary(mela.cox <- coxph(Surv(survival_time, vital_status)~stage+age+
NER,
data=cut.mela))
cut.coh
cut.ther1 <- summary(mela.cox.ther1 <- coxph(Surv(survival_time, vital_status)~stage+treatment1+
S6,
data=cut.mela1))
# Survival by treatment
cut.mela1 <- cut.mela
cut.mela1$treatment1 <- ifelse(grepl("+ radiation", cut.mela1$treatment), "radiation + other", cut.mela1$treatment)
cut.mela1$treatment1 <- ifelse(!is.na(grepl(" + ", cut.mela1$treatment)), "radiation + other", cut.mela$treatment)
cut.ther1 <- summary(mela.cox.ther1 <- coxph(Surv(survival_time, vital_status)~stage+treatment1+
S6,
data=cut.mela1))
head(cut.mela1)
unique(cut.mela1$treatment1)
cut.ther <- summary(mela.cox.ther <- coxph(Surv(survival_time, vital_status)~stage+treatment+
S6,
data=cut.mela))
cut.ther
# Survival by treatment
cut.mela1 <- cut.mela
cut.mela1$treatment1 <- ifelse(grepl("+ radiation", cut.mela1$treatment), "radiation + other", cut.mela1$treatment)
cut.mela1$treatment1 <- ifelse(!is.na(grepl(" + ", cut.mela1$treatment)), "radiation + other", cut.mela$treatment)
cut.mela1
# Survival by treatment
cut.mela1 <- cut.mela
head(cut.mela1)
table(cut.mela1$treatment)
cut.mela1$treatment1 <- ifelse(grepl("+ radiation", cut.mela1$treatment), "radiation + other", cut.mela1$treatment)
table(cut.mela1$treatment1)
cut.ther1 <- summary(mela.cox.ther1 <- coxph(Surv(survival_time, vital_status)~stage+treatment1+
S6,
data=cut.mela1))
cut.ther
# Therapy
m <- as.data.frame(cut.ther1[[7]])
n <- as.data.frame(cut.ther1[[8]])
cut.ther.mod <- cbind(rownames(m), m, n[,c(3:4)])
colnames(cut.ther.mod) <- c("var","coef", "HR", "SE", "z", "p", "CI_low", "CI_high")
var.ord2 <- cut.ther.mod$var
wther <- ggplot(cut.ther.mod, aes(x=factor(var, levels=var.ord2), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,100,2)) +
coord_cartesian(ylim=c(-3.5,11), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=12)) +
scale_x_discrete(labels=c("Stage\nII", "Stage\nIII", "Stage\nIV", "Immuno-\ntherapy", "Interferon",
"No\ntreatment", "Radiation", "Radiation\n+ other", "Surgery","S6",
"SKCA\nBR", "SKCM\nTM")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[1], digits=3))) +
annotate("text", x=2, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[2], digits=3))) +
annotate("text", x=3, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[3], digits=3))) +
annotate("text", x=4, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[4], digits=3))) +
annotate("text", x=5, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[5], digits=3))) +
annotate("text", x=6, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[6], digits=3))) +
annotate("text", x=7, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[7], digits=3))) +
annotate("text", x=8, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[8], digits=3))) +
annotate("text", x=9, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[9], digits=3))) +
annotate("text", x=10, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[10], digits=3))) +
annotate("text", x=11, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[11], digits=3))) +
annotate("text", x=12, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[12], digits=3)))
library(ggplot2)
library(ggpubr)
wther
wther <- ggplot(cut.ther.mod, aes(x=factor(var, levels=var.ord2), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,100,2)) +
coord_cartesian(ylim=c(-3.5,11), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=12)) +
scale_x_discrete(labels=c("Stage\nII", "Stage\nIII", "Stage\nIV", "Immuno-\ntherapy", "Interferon",
"No\ntreatment", "Radiation", "Radiation\n+ other", "Surgery","S6",
"SKCA\nBR", "SKCM\nTM")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[1], digits=3))) +
annotate("text", x=2, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[2], digits=3))) +
annotate("text", x=3, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[3], digits=3))) +
annotate("text", x=4, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[4], digits=3))) +
annotate("text", x=5, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[5], digits=3))) +
annotate("text", x=6, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[6], digits=3))) +
annotate("text", x=7, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[7], digits=3))) +
annotate("text", x=8, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[8], digits=3))) +
annotate("text", x=9, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[9], digits=3))) +
annotate("text", x=10, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[10], digits=3))) +
annotate("text", x=11, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[11], digits=3))) +
annotate("text", x=12, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[12], digits=3)))
wther
wther <- ggplot(cut.ther.mod, aes(x=factor(var, levels=var.ord2), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,100,2)) +
coord_cartesian(ylim=c(-3.5,11), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=12)) +
scale_x_discrete(labels=c("Stage\nII", "Stage\nIII", "Stage\nIV", "Immuno-\ntherapy", "Interferon",
"No\ntreatment", "Radiation", "Radiation\n+ other", "Surgery","S6",
"SKCA\nBR", "SKCM\nTM")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[1], digits=3))) +
annotate("text", x=2, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[2], digits=3))) +
annotate("text", x=3, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[3], digits=3))) +
annotate("text", x=4, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[4], digits=3))) +
annotate("text", x=5, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[5], digits=3))) +
annotate("text", x=6, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[6], digits=3))) +
annotate("text", x=7, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[7], digits=3))) +
annotate("text", x=8, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[8], digits=3))) +
annotate("text", x=9, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[9], digits=3))) +
annotate("text", x=10, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[10], digits=3)))
wther
# Multivariate no therapy
cut <- summary(mela.cox <- coxph(Surv(survival_time, vital_status)~stage+age+
S1+MMR,
data=cut.mela))
cut.coh <- summary(mela.cox <- coxph(Surv(survival_time, vital_status)~stage+age+
NER+cohort,
data=cut.mela))
# Multivariate with therapy
cut.ther <- summary(mela.cox.ther <- coxph(Surv(survival_time, vital_status)~stage+treatment+
S6+cohort,
data=cut.mela))
cut.ther <- summary(mela.cox.ther <- coxph(Surv(survival_time, vital_status)~stage+treatment+
S6,
data=cut.mela))
# Multivariate with therapy
cut.ther <- summary(mela.cox.ther <- coxph(Surv(survival_time, vital_status)~stage+treatment+
S6+cohort,
data=cut.mela))
# No therapy, no cohort
i <- as.data.frame(cut[[7]])
j <- as.data.frame(cut[[8]])
cut.mod <- cbind(rownames(i), i, j[,c(3:4)])
colnames(cut.mod) <- c("var","coef", "HR", "SE", "z", "p", "CI_low", "CI_high")
ggplot(cut.mod[3:6,], aes(x=factor(var, cut.mod$var), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,20,1)) +
coord_cartesian(ylim=c(-1,4), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=12)) +
#scale_x_discrete(labels=c("Age", "MMR\nsigs", "S1","Stage\nIII")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-1, label=paste0("p=",round(cut.mod$p[3], digits=3))) +
annotate("text", x=2, y=-1, label=paste0("p=",round(cut.mod$p[4], digits=4))) +
annotate("text", x=3, y=-1, label=paste0("p=",round(cut.mod$p[5], digits=5))) +
annotate("text", x=4, y=-1, label=paste0("p=",round(cut.mod$p[6], digits=3)))
# No therapy, cohort
k <- as.data.frame(cut.coh[[7]])
l <- as.data.frame(cut.coh[[8]])
cut.coh.mod <- cbind(rownames(k), k, l[,c(3:4)])
colnames(cut.coh.mod) <- c("var","coef", "HR", "SE", "z", "p", "CI_low", "CI_high")
var.ord <- cut.coh.mod$var
ggplot(cut.coh.mod[3:8,], aes(x=factor(var, levels=var.ord), y=coef))
wother <- ggplot(cut.coh.mod, aes(x=factor(var, levels=var.ord), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,20,1)) +
coord_cartesian(ylim=c(-1,3), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=15),
axis.text = element_text(size=14)) +
scale_x_discrete(labels=c("Stage\nII","Stage\nIII","Stage\nIV", "Age", "NER\nsigs","SKCA\nBR", "SKCM\nTM", "SKCM\nTP")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-1, label=paste0("p=",round(cut.coh.mod$p[1], digits=3))) +
annotate("text", x=2, y=-1, label=paste0("p=",round(cut.coh.mod$p[2], digits=3))) +
annotate("text", x=3, y=-1, label=paste0("p=",round(cut.coh.mod$p[3], digits=3))) +
annotate("text", x=4, y=-1, label=paste0("p=",round(cut.coh.mod$p[4], digits=7))) +
annotate("text", x=5, y=-1, label=paste0("p=",round(cut.coh.mod$p[5], digits=3))) +
annotate("text", x=6, y=-1, label=paste0("p=",round(cut.coh.mod$p[6], digits=3))) +
annotate("text", x=7, y=-1, label=paste0("p=",round(cut.coh.mod$p[7], digits=8))) +
annotate("text", x=8, y=-1, label=paste0("p<2e-16"))
ggarrange(wother, wther,
nrow=2,
labels = c("a)", "b)"))
pdf("./Figures/TCGA_ICGC_comb_survival2.pdf", w=10, h=10)
ggarrange(wother, wther,
nrow=2,
labels = c("a)", "b)"))
dev.off()
pdf("./Figures/TCGA_ICGC_comb_survival2.pdf", w=10, h=10)
ggarrange(wother, wther,
nrow=2,
labels = c("a)", "b)"))
dev.off()
wther <- ggplot(cut.ther.mod, aes(x=factor(var, levels=var.ord2), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,100,2)) +
coord_cartesian(ylim=c(-3.5,11), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=12)) +
scale_x_discrete(labels=c("Stage\nII", "Stage\nIII", "Stage\nIV", "Immuno-\ntherapy", "Interferon",
"No\ntreatment", "Radiation", "Radiation\n+ other", "Surgery","S6",
"SKCA\nBR", "SKCM\nTM")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[1], digits=3))) +
annotate("text", x=2, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[2], digits=3))) +
annotate("text", x=3, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[3], digits=3))) +
annotate("text", x=4, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[4], digits=3))) +
annotate("text", x=5, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[5], digits=3))) +
annotate("text", x=6, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[6], digits=3))) +
annotate("text", x=7, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[7], digits=3))) +
annotate("text", x=8, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[8], digits=3))) +
annotate("text", x=9, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[9], digits=5))) +
annotate("text", x=10, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[10], digits=3)))
woth
wther
pdf("./Figures/TCGA_ICGC_comb_survival2.pdf", w=10, h=10)
ggarrange(wother, wther,
nrow=2,
labels = c("a)", "b)"))
dev.off()
wther <- ggplot(cut.ther.mod, aes(x=factor(var, levels=var.ord2), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,100,2)) +
coord_cartesian(ylim=c(-3.5,11), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=12)) +
scale_x_discrete(labels=c("Stage\nII", "Stage\nIII", "Stage\nIV", "Immuno-\ntherapy", "Interferon",
"No\ntreatment", "Radiation", "Radiation\n+ other", "Surgery","S6",
"SKCA\nBR", "SKCM\nTM")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[1], digits=3))) +
annotate("text", x=2, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[2], digits=3))) +
annotate("text", x=3, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[3], digits=3))) +
annotate("text", x=4, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[4], digits=3))) +
annotate("text", x=5, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[5], digits=3))) +
annotate("text", x=6, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[6], digits=3))) +
annotate("text", x=7, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[7], digits=3))) +
annotate("text", x=8, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[8], digits=3))) +
annotate("text", x=9, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[9], digits=4))) +
annotate("text", x=10, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[10], digits=3)))
pdf("./Figures/TCGA_ICGC_comb_survival2.pdf", w=10, h=10)
ggarrange(wother, wther,
nrow=2,
labels = c("a)", "b)"))
dev.off()
ggplot(cut.ther.mod, aes(x=factor(var, levels=var.ord2), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,100,2)) +
coord_cartesian(ylim=c(-3.5,12), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=12)) +
scale_x_discrete(labels=c("Stage\nII", "Stage\nIII", "Stage\nIV", "Immuno-\ntherapy", "Interferon",
"No\ntreatment", "Radiation", "Radiation\n+ other", "Surgery","S6",
"SKCA\nBR", "SKCM\nTM")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[1], digits=3))) +
annotate("text", x=2, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[2], digits=3))) +
annotate("text", x=3, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[3], digits=3))) +
annotate("text", x=4, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[4], digits=3))) +
annotate("text", x=5, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[5], digits=3))) +
annotate("text", x=6, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[6], digits=3))) +
annotate("text", x=7, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[7], digits=3))) +
annotate("text", x=8, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[8], digits=3))) +
annotate("text", x=9, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[9], digits=4))) +
annotate("text", x=10, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[10], digits=3)))
wther <- ggplot(cut.ther.mod, aes(x=factor(var, levels=var.ord2), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,100,2)) +
coord_cartesian(ylim=c(-3.5,12), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=12)) +
scale_x_discrete(labels=c("Stage\nII", "Stage\nIII", "Stage\nIV", "Immuno-\ntherapy", "Interferon",
"No\ntreatment", "Radiation", "Radiation\n+ other", "Surgery","S6",
"SKCA\nBR", "SKCM\nTM")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[1], digits=3))) +
annotate("text", x=2, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[2], digits=3))) +
annotate("text", x=3, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[3], digits=3))) +
annotate("text", x=4, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[4], digits=3))) +
annotate("text", x=5, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[5], digits=3))) +
annotate("text", x=6, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[6], digits=3))) +
annotate("text", x=7, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[7], digits=3))) +
annotate("text", x=8, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[8], digits=3))) +
annotate("text", x=9, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[9], digits=4))) +
annotate("text", x=10, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[10], digits=3)))
pdf("./Figures/TCGA_ICGC_comb_survival2.pdf", w=10, h=10)
ggarrange(wother, wther,
nrow=2,
labels = c("a)", "b)"))
dev.off()
wther <- ggplot(cut.ther.mod, aes(x=factor(var, levels=var.ord2), y=coef)) +
scale_color_manual(values = c("(-Inf,0]" = "blue",
"(0, Inf]" = "red")) +
geom_errorbar(aes(ymin=coef-SE, ymax=coef+SE), width=0.05) +
geom_point(aes(colour = cut(coef, c(-Inf, 0, Inf))),
size = 3) +
ggtitle("") +
ylab("log(HR)") +
scale_y_continuous(breaks=seq(-10,100,2)) +
coord_cartesian(ylim=c(-3.5,12), expand=TRUE) +
theme_bw() +
theme(legend.position="none",
axis.title.x=element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=12)) +
scale_x_discrete(labels=c("Stage\nII", "Stage\nIII", "Stage\nIV", "Immuno-\ntherapy", "Interferon",
"No\ntreatment", "Radiation", "Radiation\n+ other", "Surgery","S6\n(MMR)",
"SKCA\nBR", "SKCM\nTM")) +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
annotate("text", x=1, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[1], digits=3))) +
annotate("text", x=2, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[2], digits=3))) +
annotate("text", x=3, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[3], digits=3))) +
annotate("text", x=4, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[4], digits=3))) +
annotate("text", x=5, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[5], digits=3))) +
annotate("text", x=6, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[6], digits=3))) +
annotate("text", x=7, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[7], digits=3))) +
annotate("text", x=8, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[8], digits=3))) +
annotate("text", x=9, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[9], digits=4))) +
annotate("text", x=10, y=-3.5, label=paste0("p=",round(cut.ther.mod$p[10], digits=3)))
pdf("./Figures/TCGA_ICGC_comb_survival2.pdf", w=10, h=10)
ggarrange(wother, wther,
nrow=2,
labels = c("a)", "b)"))
dev.off()
pdf("./Figures/TCGA_ICGC_comb_survival2.pdf", w=10, h=10)
ggarrange(wother, wther,
nrow=2,
labels = c("a)", "b)"))
dev.off()
