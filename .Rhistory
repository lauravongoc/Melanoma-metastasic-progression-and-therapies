soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
soo[is.na(soo)] <- 500
sgood <- soo[which(soo$D == 1),]
goods <- append(goods, sgood$s[which(sgood$r2==min(sgood$r2))])
goods
res
soo <- data.frame(s=seq(0, 1, by=0.01), AB=NA, Ab=NA, aB=NA, ab=NA, D=NA, r2=NA)
j <- 1
for (i in seq(0, 1, by=0.01)) {
res <- ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=i, mu=0)
soo[j,2] <- res[2]
soo[j,3] <- res[3]
soo[j,4] <- res[4]
soo[j,5] <- res[5]
soo[j,6] <- res[6]
soo[j,7] <- res[7]
j <- j+1
}
head(soo)
# LDSEL
ldsel = function(ngen=500,nall=2000,init=c(0.5,0.01,0.01,0.48),rho=0,s=0,mu=0) {
hp = matrix(0,ngen,4)
p = rep(0,4)
hp[1,] = init/sum(init)
ldstat = matrix(0,ngen,2)
p1 = hp[1,1]+hp[1,2]		# allele prop at loc 1
p2 = hp[1,1]+hp[1,3]		# allele prop at loc 2
for(i in 2:ngen) {
# haplotype proportions in next generation after recombination:
pp = hp[i-1,]*(1-rho)+rho*c(p1*p2,p1*(1-p2),(1-p1)*p2,(1-p1)*(1-p2))
# now let's have some mutation and selection:
p[1] = sum(pp*c((1-mu)^2,mu*(1-mu),mu*(1-mu),mu^2))
p[2] = sum(pp*c(mu*(1-mu),(1-mu)^2,mu^2,mu*(1-mu)))*(1+s)
p[3] = sum(pp*c(mu*(1-mu),mu^2,(1-mu)^2,mu*(1-mu)))
p[4] = sum(pp*c(mu^2,mu*(1-mu),mu*(1-mu),(1-mu)^2))
# sample haplotypes in next generation and record counts
tmp = sample(1:4,nall,repl=T,prob=p)
for (j in 1:4) hp[i,j]=sum(tmp==j)/nall
p1 = hp[i,1]+hp[i,2]		# allele prop at loc 1
p2 = hp[i,1]+hp[i,3]		# allele prop at loc 2
# compute D'_00
D00 = hp[i,1]-p1*p2
if(D00>0) ldstat[i,1] = D00/min(p1*(1-p2),p2*(1-p1))
if(D00<=0) ldstat[i,1] = -D00/min(p1*p2,(1-p2)*(1-p1))
# compute r^2_00
ldstat[i,2] = D00^2/(p1*p2*(1-p1)*(1-p2))
}
pA=apply(hp[,1:2],1,sum)
pB=apply(hp[,c(1,3)],1,sum)
to.plot='yes'
if (to.plot=='yes') {
lwd.val=2
par(mfrow=c(2,1),mar=c(3,2,2,1))
matplot(hp[,1:4],type="l",xlim=c(0,ngen*1.2),ylim=c(0,1),lty=1,lwd=lwd.val,xlab="",ylab="haplotype proportion",main=paste("LD: rho=",rho,", s=",s,", mu=",mu,sep=''))
lines(1:dim(hp)[1],pA,lty=1,lwd=2*lwd.val,col=5)
lines(1:dim(hp)[1],pB,lty=1,lwd=2*lwd.val,col=6)
legend(ngen,1,leg=c("AB","Ab","aB","ab","A","B"),lty=1,col=1:6,lwd=2,cex=1.4)
ylim.plot=c(0,max(c(ldstat)))
if (sum(is.na(ylim.plot))!=0) ylim.plot=c(0,1)
matplot(ldstat[-1,],type="l",xlim=c(0,ngen*1.2),ylim=ylim.plot,lty=1,lwd=lwd.val,col=3:4,xlab="",ylab="")
legend(ngen,max(ylim.plot),leg=c("|D'|","r^2"),lty=1,col=3:4,lwd=2,cex=1.4)
}
return(c(hp[ngen,],ldstat[ngen,]))
}
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.06, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.02, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.03, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.04, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.02, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.03, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.04, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.05, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.06, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.06, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.06, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.06, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.06, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.06, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.06, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.06, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.9, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.9, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.9, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=001, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0.01, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0.01, mu=0)
ldsel(ngen=500, nall=2000, init=c(0.5, 0.01, 0.01, 0.48), rho=0, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.01), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.48), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.01, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 1), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.1, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
ldsel(ngen=100, nall=117, init=c(0.5, 0.01, 0.01, 0.2), rho=0.98, s=0.0001, mu=0)
library(ggplot2)
library(pheatmap)
library(RColorBrewer)
library(reshape2)
require(FirebrowseR)
#--------- WD & LOAD FILES --------------------------------------------------------------------------------------------
setwd("C:/Users/rockp/Desktop/UCL/Project/Project-Laura")
# Mutational signatures and clinical data
load("./Output/TCGA_SKCM_TP_clinical.RData")    # SKCM TP
load('./Output/TCGA_SKCM_TM_clinical.RData')    # SKCM TM
# Stage
load("./Output/TCGA_SKCM_TP_stage.RData")       # SKCM TP
load("./Output/TCGA_SKCM_TM_stage.RData")       # SKCM TM
# Expression matrix
load("./Output/TCGA_SKCM_TP_expression_mel_matrix.RData")  # SKCM TP
load("./Output/TCGA_SKCM_TM_expression_mel_matrix.RData")  # SKCM TM
load("./Output/TCGA_UVM_TP_clinical.RData")     # UVM TP
load("./Output/TCGA_UVM_TP_stage.RData")        # UVM TP
# Gene lists
load("./Output/TCGA_SKCM_metastatic_genelist.RData")            # SKCM metastasis genelist
load("./Output/TCGA_SKCM_metastatic_genelist_upreg.RData")      # SKCM metastasis upreg genelist
load("./Output/TCGA_SKCM_metastatic_genelist_downreg.RData")    # SKCM metastasis downreg genelist
# Metastatic score
load("./Output/TCGA_SKCM_TP_metastatic_score_mel.RData")  # SKCM TP
load("./Output/TCGA_SKCM_TM_metastatic_score_mel.RData")  # SKCM TM
# Mutsigs, metscores, and stage
load("./Output/TCGA_SKCM_TP_metastatic_score_stage.RData")  # SKCM TP
load("./Output/TCGA_SKCM_TM_metastatic_score_stage.RData")  # SKCM TM
library("BSgenome.Hsapiens.UCSC.hg38")
library(deconstructSigs)
library(TCGAbiolinks)
